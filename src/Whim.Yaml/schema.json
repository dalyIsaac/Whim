{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/dalyIsaac/Whim/main/src/Whim/Config/schema.json",

  "type": "object",
  "additionalProperties": false,

  "properties": {
    "keybinds": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": { "$ref": "#/$defs/Keybind" },
          "description": "Mappings of commands to keybinds"
        },

        "unify_key_modifiers": {
          "type": "boolean",
          "description": "Whether to treat key modifiers like `LWin` and `RWin` as the same key modifier. Defaults to `true`.",
          "default": true
        }
      }
    },

    "filters": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": { "$ref": "#/$defs/Filter" },
          "description": "Filters to apply to windows to determine whether they should be managed by Whim"
        }
      }
    },

    "routers": {
      "type": "object",
      "properties": {
        "entries": {
          "type": "array",
          "items": { "$ref": "#/$defs/Router" },
          "description": "Routers to determine which workspace a window should be placed in"
        },

        "routing_behavior": {
          "$ref": "#/$defs/RoutingBehavior",
          "description": "The behavior to use when routing windows to workspaces"
        }
      }
    },

    "plugins": {
      "type": "object",
      "properties": {
        "gaps": {
          "$ref": "#/$defs/GapsPlugin",
          "description": "Plugin to add gaps between windows"
        },

        "command_palette": {
          "$ref": "#/$defs/CommandPalettePlugin",
          "description": "Plugin to add a command palette"
        }
      }
    }
  },

  "$defs": {
    "Keybind": {
      "type": "object",
      "required": ["command", "keybind"],
      "additionalProperties": false,
      "properties": {
        "command": {
          "type": "string",
          "description": "The identifier of the command to run. For more, see https://dalyisaac.github.io/Whim/docs/customize/commands.html"
        },
        "keybind": {
          "type": "string",
          "description": "The keybind to trigger the command. For more, see https://dalyisaac.github.io/Whim/docs/customize/keybinds.html"
        }
      }
    },

    "Filter": {
      "type": "object",
      "required": ["filter_type", "value"],
      "additionalProperties": false,
      "properties": {
        "filter_type": {
          "anyOf": [
            {
              "const": "window_class",
              "description": "Ignores windows with the specified window class"
            },
            {
              "const": "process_file_name",
              "description": "Ignores windows with the specified process file name"
            },
            {
              "const": "title",
              "description": "Ignores windows with the specified title"
            },
            {
              "const": "title_regex",
              "description": "Ignores windows with a title that matches the specified regex"
            }
          ]
        },
        "value": {
          "type": "string",
          "description": "The value to filter by"
        }
      }
    },

    "Router": {
      "type": "object",
      "required": ["router_type", "value", "workspace_name"],
      "additionalProperties": false,
      "properties": {
        "router_type": {
          "anyOf": [
            {
              "const": "window_class",
              "description": "Routes windows with the specified window class to the specified workspace"
            },
            {
              "const": "process_file_name",
              "description": "Routes windows with the specified process file name to the specified workspace"
            },
            {
              "const": "title",
              "description": "Routes windows with the specified title to the specified workspace"
            },
            {
              "const": "title_regex",
              "description": "Routes windows with a title that matches the specified regex to the specified workspace"
            }
          ]
        },
        "value": { "type": "string", "description": "The value to route by" },
        "workspace_name": {
          "type": "string",
          "description": "The workspace to route to"
        }
      }
    },

    "RoutingBehavior": {
      "anyOf": [
        {
          "const": "route_to_launched_workspace",
          "description": "Routes windows to the workspace that the window was launched on by Windows."
        },
        {
          "const": "route_to_active_workspace",
          "description": "Routes windows to the workspace which last received an event sent by Windows."
        },
        {
          "const": "route_to_last_tracked_active_workspace",
          "description": "Routes windows to the workspace which last received an event sent by Windows which Whim did not ignore."
        }
      ],
      "default": "route_to_launched_workspace"
    },

    "WindowBackdropConfig": {
      "type": "object",
      "description": "WinUI supports different backdrops/materials, depending on the OS version. To see the different materials available, see <see href='https://learn.microsoft.com/en-us/windows/apps/design/signature-experiences/materials'/>. The different materials support differing levels and style of transparency. This config lets you specify which backdrop to use for a given Whim window.",
      "properties": {
        "backdrop_type": {
          "anyOf": [
            {
              "const": "none",
              "description": "No backdrop"
            },
            {
              "const": "acrylic",
              "description": "Acrylic backdrop - see <see href='https://learn.microsoft.com/en-us/windows/apps/design/style/acrylic'/>."
            },
            {
              "const": "acrylic_thin",
              "description": "A more transparent Acrylic backdrop - based on the Acrylic backdrop."
            },
            {
              "const": "mica",
              "description": "Mica backdrop - see <see href='https://learn.microsoft.com/en-us/windows/apps/design/style/mica'/>. Unsupported on Windows 10 - Whim will fall back to Acrylic."
            },
            {
              "const": "mica_alt",
              "description": "A Mica variant which looks different to Mica - see <see href='https://learn.microsoft.com/en-us/windows/apps/design/style/mica'/>. Unsupported on Windows 10 - Whim will fall back to Acrylic."
            }
          ],
          "default": "mica"
        },
        "always_show_backdrop": {
          "type": "boolean",
          "description": "By default, WinUI will disable the backdrop when the window loses focus. Whim overrides this setting. Set this to false to disable the backdrop when the window loses focus.",
          "default": true
        }
      }
    },

    "GapsPlugin": {
      "type": "object",
      "description": "Plugin to add gaps between windows. For more, see https://dalyisaac.github.io/Whim/docs/plugins/gaps.html",
      "additionalProperties": false,
      "properties": {
        "is_enabled": {
          "type": "boolean",
          "description": "Whether the plugin is enabled",
          "default": true
        },
        "outer_gap": {
          "type": "integer",
          "description": "The gap between the parent layout engine and the area where windows are placed",
          "default": 10
        },
        "inner_gap": {
          "type": "integer",
          "description": "The gap between windows",
          "default": 10
        },
        "default_outer_delta": {
          "type": "integer",
          "description": "The default outer gap used by commands `gaps.outer.increase` and `gaps.outer.decrease`",
          "default": 2
        },
        "default_inner_delta": {
          "type": "integer",
          "description": "The default inner gap used by commands `gaps.inner.increase` and `gaps.inner.decrease`",
          "default": 2
        }
      }
    },

    "CommandPalettePlugin": {
      "type": "object",
      "description": "Plugin to add a command palette. For more, see https://dalyisaac.github.io/Whim/docs/plugins/command-palette.html",
      "additionalProperties": false,
      "properties": {
        "is_enabled": {
          "type": "boolean",
          "description": "Whether the plugin is enabled",
          "default": true
        },
        "max_height_percent": {
          "type": "integer",
          "description": "The maximum height of the command palette as a percentage of the monitor height",
          "default": 40
        },
        "max_width_pixels": {
          "type": "integer",
          "description": "The maximum width of the command palette in pixels",
          "default": 800
        },
        "y_position_percent": {
          "type": "integer",
          "description": "The y position of the command palette as a percentage of the monitor height",
          "default": 20
        },
        "backdrop": {
          "$ref": "#/$defs/WindowBackdropConfig",
          "description": "The backdrop to use for the command palette"
        }
      }
    }
  }
}
